name: Linux 20.04 (amd64)

on:
  push:
  workflow_dispatch:
    
jobs:

  ci:
    runs-on: ubuntu-20.04
    steps:
      - name: Test
        run: |
          export SIREUM_V=4.20241017.f6e1eff
          mkdir -p ~/Applications ~/Downloads
          curl -JLso ~/Downloads/sireum-ive-linux-amd64.tar.xz https://github.com/sireum/kekinian/releases/download/$SIREUM_V/sireum-ive-linux-amd64.tar.xz
          curl -JLso ~/Downloads/org.sireum.library.m2.zip https://github.com/sireum/kekinian/releases/download/$SIREUM_V/org.sireum.library.m2.zip  
          cd ~/Applications
          tar xf ~/Downloads/sireum-ive-linux-amd64.tar.xz
          cd ~
          unzip ~/Downloads/org.sireum.library.m2.zip

          export SIREUM_HOME=~/Applications/Sireum
          
          cat $SIREUM_HOME/versions.properties
          echo "--------------"
          sed -i '/.*z3.*/c\org.sireum.version.z3=4.11.2' $SIREUM_HOME/versions.properties
          echo "--------------"
          cat $SIREUM_HOME/versions.properties

          git clone https://github.com/jasonbelt/logika-examples.git
          logika-examples/bin/verify.cmd
          "${SIREUM_HOME}/bin/sireum" proyek ive logika-examples
